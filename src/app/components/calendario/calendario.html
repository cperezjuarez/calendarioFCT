<div class="calendari-container">

    <!-- Formulari d'entrada (Part 1 - Els alumnes completaran això) -->
    <div class="formulari-practiques">
        <h2>Planificació de pràctiques FCT</h2>

        <div class="camps-formulari">
            <section class="max-w-3xl mx-auto p-6 bg-white/80 rounded-lg shadow-md mt-8">
                <h2 class="text-2xl font-semibold mb-4">Configuración</h2>
                <form class="space-y-6" [formGroup]="form">
                    <div>
                        <label for="fechaInicio" class="block text-sm font-medium text-gray-700 mb-1">Fecha
                            Inicio</label>
                        <input type="date" name="fecha" formControlName="fechaInicio" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-400" />
                    </div>

                    <div>
                        <label for="horasTotales" class="block text-sm font-medium text-gray-700 mb-1">Horas
                            Totales</label>
                        <input type="number" name="horasTotales" formControlName="horasTotales" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-400" />
                        @if (form.get('horasTotales')?.invalid && form.get('horasTotales')?.touched) {
                        <p class="text-red-400 text-sm mt-1">
                            @if (form.get('horasTotales')?.errors?.['min']) { Las horas deben de ser positivas }
                        </p>
                        }
                    </div>

                    <div>
                        <label for="horasDiarias" class="block text-sm font-medium text-gray-700 mb-1">Horas al
                            dia</label>
                        <input type="number" name="horasDiarias" formControlName="horasDiarias" required
                            class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-400" />
                        @if (form.get('horasDiarias')?.invalid && form.get('horasDiarias')?.touched) {
                        <p class="text-red-400 text-sm mt-1">
                            @if (form.get('horasDiarias')?.errors?.['min']) { Las horas deben de ser positivas }
                        </p>
                        }
                    </div>
                </form>
            </section>
        </div>

        <!-- Missatge amb el resultat (Part 2) -->
        <div class="resultat" *ngIf="periodoPracticas">
            <p><strong>Data d'inici:</strong> {{ periodoPracticas?.fechaInicial | date:'dd/MM/yyyy' }}</p>
            <p><strong>Data final prevista:</strong> {{ periodoPracticas?.fechaFinal | date:'dd/MM/yyyy' }}</p>
            <p><strong>Dies laborables: </strong> {{ periodoPracticas?.diasLaborales }}</p>
        </div>
    </div>

    <!-- Calendari visual -->
    <div class="calendari-anys">
        <h3>Any {{ yearActual }}</h3>

        <div class="grid-mesos">
            <div class="mes" *ngFor="let dias of meses; let i = index">

                <!-- Capçalera del mes -->
                <div class="mes-header">
                    <h4>{{ getNombreMes(i) }}</h4>
                </div>

                <!-- Dies de la setmana -->
                <div class="dies-setmana">
                    <div class="dia-setmana">Dl</div>
                    <div class="dia-setmana">Dt</div>
                    <div class="dia-setmana">Dc</div>
                    <div class="dia-setmana">Dj</div>
                    <div class="dia-setmana">Dv</div>
                    <div class="dia-setmana">Ds</div>
                    <div class="dia-setmana">Dg</div>
                </div>

                <!-- Grid de dies del mes -->
                <div class="grid-dies">
                    <div *ngFor="let dia of dias" class="dia" 
                    [class.fora-mes]="!dia.estaDentroDelMes"
                    [class.cap-setmana]="dia.esFinDeSemana" 
                    [class.festiu]="dia.esFestivo"
                    [class.dia-practiques]="dia.esDiaPracticas">
                        {{ dia.numero }}
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Llegenda -->
    <div class="llegenda">
        <div class="llegenda-item">
            <span class="color-box dia-practiques"></span>
            <span>Dies de pràctiques</span>
        </div>
        <div class="llegenda-item">
            <span class="color-box festiu"></span>
            <span>Dies festius</span>
        </div>
        <div class="llegenda-item">
            <span class="color-box cap-setmana"></span>
            <span>Cap de setmana</span>
        </div>
    </div>

</div>